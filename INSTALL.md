# 电脑使用时间监控工具 - 安装说明

## 目录
1. [系统要求](#系统要求)
2. [方法一：使用已编译的可执行文件](#方法一使用已编译的可执行文件)
3. [方法二：从源代码运行](#方法二从源代码运行)
4. [配置文件说明](#配置文件说明)
5. [常见问题](#常见问题)

## 系统要求

- **操作系统**: Windows 7/8/10/11
- **运行库**: Visual C++ Redistributable for Visual Studio 2015-2019
- **磁盘空间**: 至少100MB可用空间
- **权限**: 普通用户权限即可，无需管理员权限

## 方法一：使用已编译的可执行文件

### 安装步骤

1. 从发布页面下载最新的发布版本压缩包
2. 将压缩包解压到任意位置（建议路径中不要包含中文）
3. 双击运行`电脑使用时间监控.exe`文件即可启动程序
4. 程序会自动在系统托盘区域显示图标

### 设置开机启动

1. 按下 `Win+R` 组合键，输入 `shell:startup` 并点击确定
2. 在打开的启动文件夹中，创建指向`电脑使用时间监控.exe`的快捷方式
3. 下次开机时，程序将自动启动

## 方法二：从源代码运行

### 前置条件

- Python 3.8或更高版本
- pip包管理器

### 安装步骤

1. 克隆或下载源代码到本地文件夹
2. 打开命令提示符或PowerShell，导航到源代码目录
3. 安装依赖：
   ```
   pip install -r requirements.txt
   ```
4. 运行程序：
   ```
   python main.py
   ```

### 从源代码创建可执行文件

1. 确保已安装所有依赖
2. 运行打包脚本：
   ```
   build.bat
   ```
3. 生成的可执行文件将位于`dist`文件夹中

## 配置文件说明

程序运行时会在同级目录下创建或使用`config.json`文件，您可以修改此文件来自定义程序行为。

### 主要配置项

| 配置项 | 描述 | 默认值 |
|-------|------|-------|
| activity_check_interval | 活动检查间隔（秒） | 60 |
| continuous_usage_alert_time | 连续使用多少分钟后提醒（分钟） | 60 |
| inactivity_reset_time | 多少分钟不活动后重置计时器（分钟） | 10 |
| app_name | 应用程序名称 | 电脑使用时间监控 |
| notification_title | 通知标题 | 休息提醒 |
| notification_message | 通知内容（{minutes}会被替换为实际时间） | 您已连续使用电脑{minutes}分钟，建议休息一下眼睛和身体。 |
| db_file | 数据库文件路径 | usage_data.db |
| auto_report | 是否自动生成报告 | true |
| report_interval_hours | 报告生成间隔（小时） | 24 |
| report_output_dir | 报告输出目录 | reports |

### 修改配置方法

1. **图形界面方式**：在系统托盘图标上右键点击，选择"设置"
2. **直接编辑配置文件**：
   - 关闭程序
   - 用文本编辑器（如记事本）打开`config.json`
   - 修改需要的配置项
   - 保存文件并重新启动程序

## 常见问题

### 启动时出现"找不到指定的模块"错误

- 请安装Visual C++ Redistributable for Visual Studio 2015-2019
- 下载地址：[Microsoft官方下载页面](https://support.microsoft.com/en-us/help/2977003/the-latest-supported-visual-c-downloads)

### 通知不显示

- 确保Windows通知中心已启用
- 检查程序的通知权限设置
- 尝试在Windows设置中重新启用应用通知

### 数据库错误

- 如果提示数据库被锁定或损坏，请尝试关闭程序
- 重命名或删除`usage_data.db`文件
- 重新启动程序，将自动创建新的数据库文件

### 程序启动后没有图标显示

- 检查系统托盘区域是否显示了程序图标
- 如果系统托盘区域已折叠，请点击展开查看
- 确保杀毒软件没有阻止程序运行

### 配置修改后不生效

- 确保保存了配置文件后重启程序
- 检查配置文件格式是否正确（JSON格式）
- 检查是否有文件访问权限问题

---

如有其他问题，请提交问题报告或联系开发者。 